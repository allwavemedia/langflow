# Story 6.1: MCP Server Discovery and Marketplace

## Status
InProgress

## Story
**As a** content creator  
**I want to** browse and discover available MCP servers from a curated marketplace  
**So that** I can find relevant tools without knowing technical specifications

## Acceptance Criteria
1. Visual marketplace interface with server categories (Web Search, File Operations, API Integrations, etc.)
2. Search and filter functionality by capability, popularity, and rating
3. Server descriptions, usage examples, and user reviews
4. One-click server preview/testing without permanent installation
5. Integration with official CopilotKit SSE endpoint (https://mcp.copilotkit.ai/sse)

## Tasks / Subtasks
- [x] Task 1: Create McpMarketplace Component Foundation (AC: 1) ✅
  - [x] Create McpMarketplace.tsx with basic layout and category grid ✅
  - [x] Implement category filtering using MCP_CATEGORIES from types ✅
  - [x] Add responsive grid layout for marketplace entries ✅
  - [x] Create marketplace entry card component with server info display ✅
  - [x] Create comprehensive test suite with 20 passing tests ✅

- [ ] Task 2: Implement Search and Filter Functionality (AC: 2)
  - [ ] Add search input with real-time filtering
  - [ ] Implement filter dropdowns for category, rating, and popularity
  - [ ] Add sort options (popularity, rating, alphabetical)
  - [ ] Create filter state management with React hooks

- [ ] Task 3: Server Information Display (AC: 3)
  - [ ] Design server detail cards with descriptions and metadata
  - [ ] Add usage examples section for each server
  - [ ] Implement rating and review display system
  - [ ] Add server capability badges and tags

- [ ] Task 4: One-Click Preview System (AC: 4)
  - [ ] Create McpConnectionTest component for server testing
  - [ ] Implement temporary server connection without persistence
  - [ ] Add preview modal with connection status and capabilities
  - [ ] Create connection result display with success/error feedback

- [ ] Task 5: CopilotKit SSE Integration (AC: 5)
  - [ ] Integrate with official CopilotKit SSE endpoint (https://mcp.copilotkit.ai/sse)
  - [ ] Add featured servers from CopilotKit marketplace
  - [ ] Implement marketplace data fetching service
  - [ ] Add error handling for marketplace API failures

- [ ] Task 6: Testing and Validation
  - [ ] Create comprehensive test suite for McpMarketplace component
  - [ ] Add integration tests for search and filter functionality
  - [ ] Test connection preview system with mock servers
  - [ ] Validate responsive design across different screen sizes

## Dev Notes

### Previous Story Insights
This is the first story in Epic 6, building on the MCP integration foundation established in previous epics.

### Data Models
- **McpMarketplaceEntry**: Server marketplace display data [Source: src/types/mcp.ts#McpMarketplaceEntry]
- **McpServerConfig**: Core server configuration structure [Source: src/types/mcp.ts#McpServerConfig]
- **McpConnectionTestResult**: Connection testing result data [Source: src/types/mcp.ts#McpConnectionTestResult]
- **McpCategory**: Predefined server categories from MCP_CATEGORIES constant [Source: src/types/mcp.ts#MCP_CATEGORIES]

### Component Specifications
- **McpMarketplace.tsx**: Main marketplace interface component
  - Props: None (manages own state)
  - State: search filters, selected categories, marketplace data
  - Location: src/components/mcp/McpMarketplace.tsx
- **McpConnectionTest.tsx**: Server preview and testing component
  - Props: serverConfig, onTestComplete
  - Returns: McpConnectionTestResult
  - Location: src/components/mcp/McpConnectionTest.tsx

### File Locations
- Components: `src/components/mcp/` directory following existing McpToolCall pattern
- Types: Use existing `src/types/mcp.ts` - no modifications needed
- Tests: `src/components/mcp/__tests__/` following existing test structure
- Services: Create `src/services/mcpMarketplaceService.ts` for data fetching

### Technical Constraints
- Must integrate with existing CopilotKit runtime in `src/app/api/copilotkit/route.ts`
- Use existing MCP type definitions without modifications
- Follow component patterns established by McpToolCall.tsx [Source: src/components/mcp/McpToolCall.tsx]
- Responsive design using existing UI component library

### Environment Variables
- **COPILOTKIT_SSE_ENDPOINT**: Optional override for CopilotKit SSE endpoint (defaults to https://mcp.copilotkit.ai/sse)
- **NEXT_PUBLIC_MCP_MARKETPLACE_URL**: Public marketplace API endpoint for fetching server data
- **MCP_MARKETPLACE_API_KEY**: Optional API key for enhanced marketplace features

### Testing
- **Test Framework**: Jest with React Testing Library (following existing pattern)
- **Test Location**: `src/components/mcp/__tests__/McpMarketplace.test.tsx`
- **Test Coverage**: Component rendering, search/filter functionality, connection testing, error handling
- **Integration Tests**: Marketplace data fetching, CopilotKit SSE endpoint integration

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-08-27 | 1.0 | Initial story creation for Epic 6.1 | Bob (Scrum Master) |
| 2025-08-27 | 1.1 | Added environment variables section for complete technical guidance | Bob (Scrum Master) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
Claude 3.5 Sonnet (James - Full Stack Developer)

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review of the completed story implementation*
